<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project GXDiag - Main Command</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* --- DASHBOARD HEADER GRID (3 KOLOM) --- */
        .top-dashboard {
            width: 100%; max-width: 1200px; 
            display: grid; 
            grid-template-columns: 1fr 1.4fr 1fr; /* Tengah lebih lebar */
            gap: 20px; margin-top: 20px; margin-bottom: 30px;
            align-items: stretch; /* Tinggi kolom sama rata */
        }

        /* --- 1. KIRI: Waktu & Adzan --- */
        .dash-left { 
            text-align: left; display: flex; flex-direction: column; justify-content: center;
        }
        .clock-big {
            font-size: 3.5rem; font-weight: 800; color: #fff; line-height: 1;
            text-shadow: 0 0 20px rgba(255,255,255,0.1); letter-spacing: -2px; margin-bottom: 10px;
        }
        .info-box {
            background: #1a1a1a; padding: 15px; border-radius: 12px; 
            border: 1px solid #333; margin-bottom: 8px;
        }
        .prayer-row { color: #00e5ff; font-weight: bold; display: flex; align-items: center; gap: 8px; font-size: 1.1rem; margin-bottom: 5px;}
        .date-row { color: #eee; font-size: 0.9rem; font-weight: bold;}
        .hijri-row { color: #888; font-size: 0.8rem; font-style: italic; margin-top: 2px;}

        /* --- 2. TENGAH: Kalender Event --- */
        .dash-center {
            background: #151515; border: 1px solid #333; border-radius: 15px;
            padding: 15px; display: flex; flex-direction: column; align-items: center;
            box-shadow: inset 0 0 30px #000;
        }
        .cal-header { font-weight: bold; color: #fff; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 2px; }
        
        .calendar-grid {
            display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; width: 100%;
            margin-bottom: 15px;
        }
        .cal-day-name { font-size: 0.7rem; color: #666; text-align: center; font-weight: bold; padding-bottom: 5px;}
        .cal-date { 
            height: 28px; display: flex; align-items: center; justify-content: center;
            font-size: 0.8rem; color: #ccc; border-radius: 5px; cursor: default;
        }
        .cal-date.today { background: #00e5ff; color: #000; font-weight: bold; box-shadow: 0 0 10px #00e5ff; }
        .cal-date.holiday { color: #ff4081; font-weight: bold; } /* Tanggal Merah */
        .cal-date.empty { background: transparent; pointer-events: none;}

        .event-ticker-box {
            width: 100%; background: #222; border-radius: 8px; padding: 10px 15px;
            border-left: 3px solid #ff4081; margin-top: auto; /* Dorong ke bawah */
        }
        .event-title { font-size: 0.65rem; color: #888; text-transform: uppercase; margin-bottom: 3px; letter-spacing: 1px;}
        .event-name { font-size: 0.9rem; color: #fff; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}

        /* --- 3. KANAN: Steam Sale --- */
        .dash-right {
            text-align: right;
            background: linear-gradient(135deg, #1a2a3a, #0f1519);
            padding: 20px; border-radius: 15px; border: 1px solid #333;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3); 
            display: flex; flex-direction: column; justify-content: center;
        }
        .steam-label { font-size: 0.75rem; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        .steam-title { font-size: 1.3rem; color: #66c0f4; font-weight: 800; margin: 5px 0; text-shadow: 0 0 10px rgba(102, 192, 244, 0.3);}
        .steam-timer { font-size: 1.6rem; color: #fff; font-family: monospace; font-weight: bold; }

        /* --- MENU GRID --- */
        .menu-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 20px; width: 100%; max-width: 1200px; margin-top: 10px; margin-bottom: 40px;
        }
        .card {
            background: #1e1e1e; border: 1px solid #333; border-radius: 15px;
            padding: 30px 20px; text-align: center; transition: 0.3s;
            display: flex; flex-direction: column; align-items: center; cursor: pointer;
            text-decoration: none; color: #eee;
        }
        .card:hover { transform: translateY(-5px); border-color: #00e5ff; box-shadow: 0 0 25px rgba(0, 229, 255, 0.15); }
        .icon { font-size: 2.5rem; margin-bottom: 10px; }
        .title { font-size: 1rem; font-weight: 800; color: #00e5ff; margin-bottom: 5px; text-transform: uppercase; }
        .desc { font-size: 0.75rem; color: #777; line-height: 1.4; }

        /* Responsive */
        @media (max-width: 900px) {
            .top-dashboard { grid-template-columns: 1fr; text-align: center; gap: 15px;}
            .dash-left, .dash-right, .dash-center { width: 100%; text-align: center; align-items: center;}
            .prayer-row { justify-content: center; }
            .event-ticker-box { text-align: center; }
        }
    </style>
</head>
<body>

    <div class="top-dashboard">
        
        <div class="dash-left">
            <div class="clock-big" id="clock">00:00:00</div>
            <div class="info-box">
                <div class="prayer-row">
                    <span>üïã</span> <span id="next-prayer">Checking Location...</span>
                </div>
                <div class="date-row" id="date-gregorian">Detecting Date...</div>
                <div class="hijri-row" id="date-hijri">Syncing Hijri...</div>
            </div>
        </div>

        <div class="dash-center">
            <div class="cal-header" id="cal-month-year">MONTH YEAR</div>
            <div class="calendar-grid" id="calendar-grid">
                </div>
            <div class="event-ticker-box">
                <div class="event-title">Upcoming Event</div>
                <div class="event-name" id="next-event">No Events Found</div>
            </div>
        </div>

        <div class="dash-right">
            <div style="font-size:2rem; margin-bottom:5px;">üéÆ</div>
            <div class="steam-label">VALVE / STEAM EVENT</div>
            <div class="steam-title" id="sale-name">Checking...</div>
            <div class="steam-timer" id="sale-countdown">--d --h</div>
        </div>
    </div>

    <div style="text-align:center; margin-bottom:20px;">
        <h2 style="margin:0; color:#00e5ff; font-size: 1.8rem; letter-spacing: 3px; font-weight:900;">PROJECT GXDIAG</h2>
        <div style="font-size: 0.8rem; color: #555; letter-spacing:1px;">HARDWARE DIAGNOSTIC SUITE V2.0</div>
    </div>

    <div class="menu-grid">
        <a href="modules/keyboard/index.html" class="card"><div class="icon">‚å®Ô∏è</div><div class="title">Keyboard</div><div class="desc">Ghosting & Chatter</div></a>
        <a href="modules/typing/index.html" class="card"><div class="icon">‚ö°</div><div class="title">Typing</div><div class="desc">Speed & Accuracy</div></a>
        <a href="modules/mouse/index.html" class="card"><div class="icon">üñ±Ô∏è</div><div class="title">Mouse</div><div class="desc">Polling Rate & Buttons</div></a>
        <a href="modules/gamepad/index.html" class="card"><div class="icon">üéÆ</div><div class="title">Controller</div><div class="desc">Deadzone & WebHID</div></a>
        <a href="modules/audio/index.html" class="card"><div class="icon">üîä</div><div class="title">Audio</div><div class="desc">Stereo & Mic Test</div></a>
        <a href="modules/sensors/index.html" class="card"><div class="icon">üì±</div><div class="title">Sensors</div><div class="desc">Gyro & Battery</div></a>
        <a href="modules/screen-cam/index.html" class="card"><div class="icon">üì∏</div><div class="title">Screen/Cam</div><div class="desc">Dead Pixel & Webcam</div></a>
        <a href="modules/specs/index.html" class="card"><div class="icon">üîç</div><div class="title">Specs/GPU</div><div class="desc">HDC Detector</div></a>
    </div>

    <footer style="margin-bottom: 20px; color: #333; font-size: 0.7rem; text-align: center;">
        &copy; 2024 Project GXDiag.
    </footer>

    <script>
        // --- DATA LIBUR NASIONAL 2025 (Estimasi) ---
        const indoHolidays = {
            "1-1": "Tahun Baru 2025", "1-27": "Isra Mi'raj", "1-29": "Imlek 2576",
            "3-29": "Nyepi Saka 1947", "3-31": "Idul Fitri 1446H", "4-1": "Idul Fitri 1446H",
            "4-18": "Wafat Isa Al Masih", "5-1": "Hari Buruh", "5-12": "Waisak 2569",
            "5-29": "Kenaikan Isa Al Masih", "6-1": "Lahir Pancasila", "6-6": "Idul Adha 1446H",
            "6-27": "1 Muharram 1447H", "8-17": "HUT RI ke-80", "9-5": "Maulid Nabi",
            "12-25": "Hari Natal"
        };

        // --- 1. CLOCK & BASIC CALENDAR (Jalan Duluan, Tanpa API) ---
        const dateEl = document.getElementById('date-gregorian');
        const clockEl = document.getElementById('clock');
        const nextEventEl = document.getElementById('next-event');

        function initClockAndCalendar() {
            const now = new Date();
            
            // Jam Realtime
            clockEl.innerText = now.toLocaleTimeString('id-ID', { hour12: false });
            dateEl.innerText = now.toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

            // Render Kalender Visual
            document.getElementById('cal-month-year').innerText = now.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
            const year = now.getFullYear();
            const month = now.getMonth();
            const today = now.getDate();
            const firstDay = new Date(year, month, 1).getDay(); 
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const grid = document.getElementById('calendar-grid');
            
            grid.innerHTML = "";
            ['S','M','T','W','T','F','S'].forEach(d => grid.innerHTML += `<div class="cal-day-name">${d}</div>`);
            for (let i = 0; i < firstDay; i++) grid.innerHTML += `<div class="cal-date empty"></div>`;

            let eventFound = false;
            for (let i = 1; i <= daysInMonth; i++) {
                const dateKey = `${month + 1}-${i}`;
                const checkDate = new Date(year, month, i);
                let classes = "cal-date";
                
                if (i === today) classes += " today";
                if (checkDate.getDay() === 0 || indoHolidays[dateKey]) classes += " holiday"; // Merah

                grid.innerHTML += `<div class="${classes}">${i}</div>`;

                if (!eventFound && i >= today && indoHolidays[dateKey]) {
                    nextEventEl.innerText = `üáÆüá© ${indoHolidays[dateKey]} (${i} ${now.toLocaleDateString('en-US',{month:'short'})})`;
                    eventFound = true;
                }
            }
            if(!eventFound) nextEventEl.innerText = "No Upcoming Holidays";
        }
        
        setInterval(initClockAndCalendar, 1000); // Update tiap detik
        initClockAndCalendar(); // Jalankan langsung saat load

        // --- 2. API LOCATION & PRAYER (Async - Tidak Bikin Macet) ---
        function loadPrayerTimes() {
            if(!navigator.geolocation) {
                document.getElementById('next-prayer').innerText = "Loc. Not Supported";
                return;
            }

            navigator.geolocation.getCurrentPosition(async (pos) => {
                const { latitude, longitude } = pos.coords;
                // Fetch API (Method 20 = Kemenag RI)
                try {
                    const url = `https://api.aladhan.com/v1/timings?latitude=${latitude}&longitude=${longitude}&method=20`;
                    const res = await fetch(url);
                    const json = await res.json();
                    
                    if(json.code === 200) {
                        const t = json.data.timings;
                        const h = json.data.date.hijri;

                        // Update Tanggal Hijriyah
                        document.getElementById('date-hijri').innerText = `${h.day} ${h.month.en} ${h.year} H`;

                        // Cek Event Hijriyah (Override event nasional jika prioritas)
                        const hDay = parseInt(h.day);
                        const hMonth = h.month.number;
                        if (hMonth === 9) document.getElementById('next-event').innerText = "üåô Ramadhan Fasting";
                        else if (hDay >= 13 && hDay <= 15) document.getElementById('next-event').innerText = "‚ú® Puasa Ayyamul Bidh";

                        // Hitung Next Prayer
                        const now = new Date();
                        const curMin = now.getHours() * 60 + now.getMinutes();
                        const prayers = [
                            {n:"Subuh", t:t.Fajr}, {n:"Dzuhur", t:t.Dhuhr}, 
                            {n:"Ashar", t:t.Asr}, {n:"Maghrib", t:t.Maghrib}, {n:"Isya", t:t.Isha}
                        ];
                        
                        let next = prayers[0]; // Default Subuh besok
                        let found = false;
                        for(let p of prayers) {
                            const [h, m] = p.t.split(':');
                            if ((parseInt(h)*60 + parseInt(m)) > curMin) { 
                                next = p; found = true; break; 
                            }
                        }
                        // Format output jam
                        document.getElementById('next-prayer').innerText = `${next.n} ${next.t}`;
                    }
                } catch(e) {
                    document.getElementById('next-prayer').innerText = "Network/API Error";
                }
            }, (err) => {
                // Fallback jika user menolak izin lokasi
                document.getElementById('next-prayer').innerText = "Location Denied";
            });
        }
        
        // Panggil fungsi lokasi sekali saat load
        loadPrayerTimes();

        // --- 3. STEAM SALE ---
        const steamSales = [
            { name: "Spring Sale", date: new Date("2025-03-14") },
            { name: "Summer Sale", date: new Date("2025-06-27") },
            { name: "Autumn Sale", date: new Date("2025-11-26") },
            { name: "Winter Sale", date: new Date("2025-12-19") }
        ];
        const now = new Date();
        const nextSale = steamSales.find(s => s.date > now) || steamSales[0];
        document.getElementById('sale-name').innerText = nextSale.name;
        const diff = nextSale.date - now;
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        document.getElementById('sale-countdown').innerText = `${days} Days Left`;
    </script>
</body>
</html>
