<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>GXDiag - Hardware Diagnostic Suite & Command Center</title>
    <meta name="description" content="Professional web-based hardware diagnostic tool.">
    <meta name="theme-color" content="#1a1a1a">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

    <link rel="stylesheet" href="css/style.css">
    <style>
        /* --- CSS VARIABLES FOR THEMES --- */
        :root {
            --c-cyan: #00e5ff;   /* Input & Standard */
            --c-purple: #d500f9; /* Audio & Voice */
            --c-orange: #ff9100; /* Image Tools */
            --c-green: #00e676;  /* Network & Connect */
            --c-red: #ff1744;    /* System & Benchmark */
            --c-pink: #f50057;   /* Forensic & Hoax */
            --c-lime: #76ff03;   /* Retro */
            --c-blue: #2979ff;   /* Tools */
            --c-alert: #ffea00;  /* Emergency */
        }

        /* DASHBOARD LAYOUT */
        .top-dashboard {
            width: 100%; max-width: 1280px; 
            display: grid; 
            grid-template-columns: 300px 1fr 300px; 
            gap: 20px; margin-top: 20px; margin-bottom: 30px;
            align-items: stretch;
        }

        /* LEFT: PRAYER */
        .dash-left { display: flex; flex-direction: column; }
        .clock-wrapper { text-align: center; margin-bottom: 15px; }
        .clock-big { font-size: 3.5rem; font-weight: 800; color: #fff; line-height: 1; text-shadow: 0 0 20px rgba(255,255,255,0.1); }
        .clock-date { font-size: 0.9rem; color: #aaa; font-weight: 500; margin-top: 5px; }

        .prayer-card {
            background: #1a1a1a; border-radius: 12px; border: 1px solid #333; 
            flex-grow: 1; display: flex; flex-direction: column; overflow: hidden;
        }
        .loc-header {
            background: #222; padding: 10px 15px; font-size: 0.8rem; color: #ccc;
            border-bottom: 1px solid #333; display: flex; align-items: center; gap: 8px;
        }
        .prayer-list { padding: 10px 0; flex-grow: 1; display: flex; flex-direction: column; justify-content: center; }
        .prayer-item {
            display: flex; justify-content: space-between; padding: 8px 20px;
            font-size: 0.95rem; color: #888; border-left: 3px solid transparent; transition: 0.2s;
        }
        .prayer-item.active { background: rgba(0, 229, 255, 0.1); color: #fff; border-left-color: #00e5ff; font-weight: bold; }
        .prayer-item.passed { color: #555; text-decoration: line-through; }
        .prayer-time { font-family: monospace; }

        /* CENTER: CALENDAR */
        .dash-center { background: #151515; border: 1px solid #333; border-radius: 15px; padding: 20px; display: flex; flex-direction: column; box-shadow: inset 0 0 50px #080808; }
        .cal-header-wrapper { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .cal-nav-btn { background: #222; border: 1px solid #444; color: #00e5ff; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.2s; user-select: none; }
        .cal-nav-btn:hover { background: #00e5ff; color: #000; }
        .cal-title { font-weight: 800; color: #fff; text-transform: uppercase; letter-spacing: 2px; font-size: 1.1rem; }
        
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; width: 100%; margin-bottom: 20px; }
        .cal-day-name { font-size: 0.75rem; color: #666; text-align: center; font-weight: bold; padding-bottom: 5px;}
        .cal-date { height: 35px; display: flex; align-items: center; justify-content: center; font-size: 0.9rem; color: #ccc; border-radius: 6px; cursor: pointer; transition: 0.2s; border: 1px solid transparent; position: relative; }
        .cal-date:hover { background: #333; border-color: #555; }
        .cal-date.today { background: rgba(0, 229, 255, 0.1); color: #00e5ff; border: 1px solid #00e5ff; font-weight: bold; }
        .cal-date.selected { background: #00e5ff; color: #000; font-weight: bold; box-shadow: 0 0 15px rgba(0, 229, 255, 0.4); transform: scale(1.1); z-index: 2;}
        .cal-date.holiday { color: #ff4081; font-weight: bold; } 
        .cal-date.has-event::after { content:''; position: absolute; bottom: 3px; width: 4px; height: 4px; background: #00ff88; border-radius: 50%; }
        
        .event-sections { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-top: auto; }
        .event-col { background: #222; padding: 10px; border-radius: 8px; font-size: 0.75rem; border-left: 3px solid #555; display: flex; flex-direction: column; }
        .ec-indo { border-color: #ff4081; } .ec-masehi { border-color: #00e5ff; } .ec-hijri { border-color: #00ff88; position: relative;}
        .ec-title { font-size: 0.65rem; color: #aaa; text-transform: uppercase; margin-bottom: 4px; font-weight: bold; }
        .ec-content { color: #fff; font-weight: 500; line-height: 1.3; }
        .hijri-select { background: #111; color: #00ff88; border: 1px solid #333; font-size: 0.65rem; border-radius: 4px; float: right;}

        /* RIGHT: STEAM ROADMAP */
        .dash-right { display: flex; flex-direction: column; gap: 15px; }
        .steam-hero { background: linear-gradient(135deg, #1a2a3a, #0f1519); padding: 20px; border-radius: 12px; border: 1px solid #333; text-align: center; box-shadow: 0 5px 20px rgba(0,0,0,0.3); }
        .steam-label { font-size: 0.7rem; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
        .steam-title { font-size: 1.2rem; color: #66c0f4; font-weight: 800; margin-bottom: 5px; text-shadow: 0 0 10px rgba(102, 192, 244, 0.3); }
        .steam-timer { font-size: 1.8rem; color: #fff; font-family: monospace; font-weight: bold; }
        .sale-live { color: #00ff88; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 0.8; } 50% { opacity: 1; } 100% { opacity: 0.8; } }
        
        .steam-roadmap { background: #1a1a1a; border-radius: 12px; border: 1px solid #333; flex-grow: 1; padding: 15px; display: flex; flex-direction: column; }
        .roadmap-title { font-size: 0.8rem; color: #aaa; text-transform: uppercase; border-bottom: 1px solid #333; padding-bottom: 8px; margin-bottom: 10px; font-weight: bold; }
        .roadmap-list { display: flex; flex-direction: column; gap: 8px; }
        .roadmap-item { display: flex; justify-content: space-between; font-size: 0.85rem; color: #777; padding: 5px 0; }
        .roadmap-item span:last-child { color: #66c0f4; font-weight: bold; }

        /* --- NEW MENU GRID & CARDS STYLING --- */
        .menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 20px; width: 100%; max-width: 1280px; margin-top: 10px; margin-bottom: 40px; }
        
        .card { 
            background: linear-gradient(145deg, #1e1e1e, #252525); 
            border: 1px solid #333; 
            border-radius: 15px; padding: 25px 20px; text-align: center; 
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); 
            display: flex; flex-direction: column; align-items: center; 
            cursor: pointer; text-decoration: none; color: #eee; 
            position: relative; overflow: hidden;
        }
        
        .card:hover { transform: translateY(-7px); box-shadow: 0 10px 30px rgba(0,0,0,0.5); border-color: var(--theme-color); }
        .card:hover .icon { text-shadow: 0 0 15px var(--theme-color); transform: scale(1.1); }
        .card:hover .title { color: var(--theme-color); }

        .icon { font-size: 2.2rem; margin-bottom: 10px; transition: 0.3s; color: #888; filter: grayscale(0.5); }
        .card:hover .icon { filter: grayscale(0); color: #fff; }
        
        .title { font-size: 1rem; font-weight: 800; color: #ccc; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; transition: 0.3s; }
        .desc { font-size: 0.75rem; color: #666; line-height: 1.4; transition: 0.3s; }
        .card:hover .desc { color: #999; }

        /* THEME CLASSES */
        .theme-input { --theme-color: var(--c-cyan); }
        .theme-audio { --theme-color: var(--c-purple); }
        .theme-media { --theme-color: var(--c-orange); }
        .theme-net   { --theme-color: var(--c-green); }
        .theme-sys   { --theme-color: var(--c-red); }
        .theme-tool  { --theme-color: var(--c-blue); }
        .theme-pink  { --theme-color: var(--c-pink); }
        .theme-alert { --theme-color: var(--c-alert); }
        .theme-retro { --theme-color: var(--c-lime); }

        /* Initial State for Icons/Titles based on theme */
        .card .icon { color: var(--theme-color); opacity: 0.8; }
        .card .title { color: #eee; }
        
        /* Subtle Bottom Border for quick ID */
        .card::after {
            content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 3px;
            background: var(--theme-color); opacity: 0.5; transition: 0.3s;
        }
        .card:hover::after { height: 5px; opacity: 1; box-shadow: 0 0 10px var(--theme-color); }

        @media (max-width: 900px) {
            .top-dashboard { grid-template-columns: 1fr; gap: 15px;}
            .event-sections { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="top-dashboard">
        
        <div class="dash-left">
            <div class="clock-wrapper">
                <div class="clock-big" id="clock">00:00</div>
                <div class="clock-date" id="clock-date">Searching Date...</div>
            </div>
            <div class="prayer-card">
                <div class="loc-header">
                    <span>üìç</span> <span id="loc-name">Mendeteksi Lokasi...</span>
                </div>
                <div class="prayer-list" id="prayer-list">
                    <div style="padding:20px; text-align:center; color:#555;">Loading...</div>
                </div>
            </div>
        </div>

        <div class="dash-center">
            <div class="cal-header-wrapper">
                <button class="cal-nav-btn" onclick="changeMonth(-1)">&lt;</button>
                <div class="cal-title" id="cal-month-year">MONTH YEAR</div>
                <button class="cal-nav-btn" onclick="changeMonth(1)">&gt;</button>
            </div>
            <div class="calendar-grid" id="calendar-grid"></div>
            <div class="event-sections">
                <div class="event-col ec-indo">
                    <div class="ec-title">üáÆüá© Nasional</div>
                    <div class="ec-content" id="info-indo">-</div>
                </div>
                <div class="event-col ec-masehi">
                    <div class="ec-title">üìÖ Detail</div>
                    <div class="ec-content" id="info-masehi">-</div>
                </div>
                <div class="event-col ec-hijri">
                    <div class="ec-title" style="display:flex; justify-content:space-between;">
                        <span>‚ò™Ô∏è Hijriyah</span>
                        <select id="hijri-offset" class="hijri-select" onchange="updateOffset()"><option value="-1">-1</option><option value="0" selected>0</option><option value="1">+1</option></select>
                    </div>
                    <div class="ec-content" id="info-hijri">-</div>
                </div>
            </div>
        </div>

        <div class="dash-right">
            <div class="steam-hero">
                <div style="font-size:1.5rem; margin-bottom:5px;">üéÆ</div>
                <div class="steam-label" id="steam-status-label">NEXT MAJOR SALE</div>
                <div class="steam-title" id="sale-name">Checking...</div>
                <div class="steam-timer" id="sale-countdown">--d --h</div>
            </div>
            <div class="steam-roadmap">
                <div class="roadmap-title">Upcoming Schedule</div>
                <div class="roadmap-list" id="steam-roadmap-list">
                    <div class="roadmap-item">Loading...</div>
                </div>
            </div>
        </div>
    </div>

    <div style="text-align:center; margin-bottom:20px;">
        <h2 style="margin:0; color:#00e5ff; font-size: 1.8rem; letter-spacing: 3px; font-weight:900;">PROJECT GXDIAG</h2>
        <div style="font-size: 0.8rem; color: #555; letter-spacing:1px;">PROFESSIONAL DIAGNOSTIC SUITE V3.2</div>
    </div>

    <div class="menu-grid">
        <a href="modules/keyboard/index.html" class="card theme-input"><div class="icon">‚å®Ô∏è</div><div class="title">Keyboard</div><div class="desc">Ghosting & Chatter</div></a>
        <a href="modules/typing/index.html" class="card theme-input"><div class="icon">‚ö°</div><div class="title">Typing</div><div class="desc">Speed & Accuracy</div></a>
        <a href="modules/mouse/index.html" class="card theme-input"><div class="icon">üñ±Ô∏è</div><div class="title">Mouse</div><div class="desc">Polling Rate & Buttons</div></a>
        <a href="modules/gamepad/index.html" class="card theme-input"><div class="icon">üéÆ</div><div class="title">Controller</div><div class="desc">Deadzone & WebHID</div></a>
        
        <a href="modules/audio/index.html" class="card theme-audio"><div class="icon">üîä</div><div class="title">Audio</div><div class="desc">Freq. Sweep & Mic</div></a>
        <a href="modules/screen-cam/index.html" class="card theme-media"><div class="icon">üì∏</div><div class="title">Screen/Cam</div><div class="desc">Dead Pixel, Repair & Cam</div></a>
        
        <a href="modules/sensors/index.html" class="card theme-sys"><div class="icon">üì±</div><div class="title">Mobile Hub</div><div class="desc">Vibration, Gyro & Battery</div></a>
        <a href="modules/specs/index.html" class="card theme-sys"><div class="icon">üîç</div><div class="title">Specs/GPU</div><div class="desc">HDC Detector</div></a>
        <a href="modules/benchmark/index.html" class="card theme-sys"><div class="icon">üöÄ</div><div class="title">Benchmark</div><div class="desc">CPU Stress Test</div></a>

        <a href="modules/network/index.html" class="card theme-net"><div class="icon">üåê</div><div class="title">Network</div><div class="desc">Ping, Speed & IP Info</div></a>
        <a href="modules/nfc/index.html" class="card theme-net"><div class="icon">üì°</div><div class="title">NFC Tool</div><div class="desc">Tag Reader (Android)</div></a>
        <a href="modules/qr/index.html" class="card theme-net"><div class="icon">üõí</div><div class="title">Barcode & QR</div><div class="desc">Scan Products & QRIS</div></a>
        <a href="modules/subnet/index.html" class="card theme-net"><div class="icon">üî¢</div><div class="title">Subnet Calc</div><div class="desc">IP Planner & VLSM</div></a>
        
        <a href="modules/reflex/index.html" class="card theme-tool"><div class="icon">‚ö°</div><div class="title">Reflex Test</div><div class="desc">Reaction Time (ms)</div></a>
        <a href="modules/gameid/index.html" class="card theme-tool"><div class="icon">üÜî</div><div class="title">Game Check</div><div class="desc">Tournament Validator</div></a>
        <a href="modules/translator/index.html" class="card theme-tool"><div class="icon">üí¨</div><div class="title">Translator</div><div class="desc">Morse, Binary & Hex</div></a>
        <a href="modules/emergency/index.html" class="card theme-alert"><div class="icon">üÜò</div><div class="title">Emergency</div><div class="desc">SOS Flash & Morse Tool</div></a>

        <a href="modules/img-converter/index.html" class="card theme-media">
            <div class="icon">üñºÔ∏è</div><div class="title">Img Convert</div><div class="desc">JPG, PNG, WEBP Tool</div>
        </a>
        <a href="modules/img-resizer/index.html" class="card theme-media">
            <div class="icon">üìè</div><div class="title">Img Resizer</div><div class="desc">Scale & 2x Resolution</div>
        </a>
        <a href="modules/img-compress/index.html" class="card theme-sys">
            <div class="icon">üóúÔ∏è</div><div class="title">Compressor</div><div class="desc">Reduce File Size</div>
        </a>

        <a href="modules/meta-detect/index.html" class="card theme-pink">
            <div class="icon">üïµÔ∏è</div><div class="title">Meta/Hoax</div><div class="desc">EXIF & Edit Detector</div>
        </a>
        <a href="modules/voice-studio/index.html" class="card theme-audio">
            <div class="icon">üéôÔ∏è</div><div class="title">Voice Studio</div><div class="desc">TTS & Speech to Text</div>
        </a>

        <a href="modules/retro-asset/index.html" class="card theme-retro">
            <div class="icon">üëæ</div><div class="title">Retro Asset</div><div class="desc">Sprite & 8-Bit Audio Gen</div>
        </a>
    </div>

    <footer style="margin-bottom: 20px; color: #333; font-size: 0.7rem; text-align: center;">
        &copy; 2025 Project GXDiag. All Systems Operational.
    </footer>

    <script>
        const fixedHolidays = { "1-1":"Tahun Baru", "5-1":"Hari Buruh", "6-1":"Lahir Pancasila", "8-17":"HUT RI", "12-25":"Natal" };
        let skbHolidays = {}; 
        let currentDate = new Date();
        let viewDate = new Date();
        let selectedDate = new Date();
        
        let hijriOffset = parseInt(localStorage.getItem('gx_hijri_offset')) || 0;
        document.getElementById('hijri-offset').value = hijriOffset;

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString('id-ID', { hour12: false });
            document.getElementById('clock-date').innerText = now.toLocaleDateString('id-ID', { weekday: 'long', day: 'numeric', month: 'long' });
        }
        setInterval(updateClock, 1000); updateClock();

        function renderPrayerList(timings) {
            if(!timings) return;
            const prayers = [{n:"Subuh", t:timings.Fajr}, {n:"Dzuhur", t:timings.Dhuhr}, {n:"Ashar", t:timings.Asr}, {n:"Maghrib", t:timings.Maghrib}, {n:"Isya", t:timings.Isha}];
            const now = new Date();
            const curMin = now.getHours() * 60 + now.getMinutes();
            let html = ""; let nextFound = false;
            prayers.forEach(p => {
                const [h, m] = p.t.split(':').map(Number);
                const pMin = h * 60 + m;
                let statusClass = "";
                if (pMin < curMin) { statusClass = "passed"; } 
                else if (!nextFound) { statusClass = "active"; nextFound = true; }
                html += `<div class="prayer-item ${statusClass}"><span>${p.n}</span><span class="prayer-time">${p.t}</span></div>`;
            });
            document.getElementById('prayer-list').innerHTML = html;
        }

        if(navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(async (pos) => {
                const { latitude, longitude } = pos.coords;
                try {
                    const geoRes = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`);
                    const geoData = await geoRes.json();
                    document.getElementById('loc-name').innerText = geoData.address.city || geoData.address.town || "Detected Location";
                } catch(e) { document.getElementById('loc-name').innerText = "GPS Coordinate"; }
                try {
                    const res = await fetch(`https://api.aladhan.com/v1/timings?latitude=${latitude}&longitude=${longitude}&method=20`);
                    const json = await res.json();
                    if(json.code === 200) renderPrayerList(json.data.timings);
                } catch(e) {}
            }, () => { document.getElementById('loc-name').innerText = "Loc Denied"; });
        }

        const steamSales = [
            { name: "Winter Sale", start: new Date("2025-12-19"), end: new Date("2026-01-02") },
            { name: "Spring Sale", start: new Date("2026-03-14"), end: new Date("2026-03-21") },
            { name: "Summer Sale", start: new Date("2026-06-25"), end: new Date("2026-07-09") },
            { name: "Autumn Sale", start: new Date("2026-11-25"), end: new Date("2026-12-02") },
            { name: "Winter Sale", start: new Date("2026-12-19"), end: new Date("2027-01-02") }
        ];

        function renderSteamInfo() {
            const today = new Date();
            let activeSale = null, nextSale = null, futureSales = [];
            steamSales.forEach(s => {
                if (today >= s.start && today <= s.end) activeSale = s;
                else if (today < s.start) { if(!nextSale) nextSale = s; else futureSales.push(s); }
            });
            const target = activeSale || nextSale;
            if(target) {
                document.getElementById('sale-name').innerText = target.name;
                const diff = activeSale ? (activeSale.end - today) : (nextSale.start - today);
                const days = Math.floor(diff / 86400000);
                if(activeSale) {
                    document.getElementById('sale-countdown').innerText = `ENDS ${days}d`;
                    document.getElementById('steam-status-label').style.color = "#00ff88";
                    document.getElementById('steam-status-label').innerText = "üî¥ LIVE NOW";
                    document.getElementById('sale-name').classList.add('sale-live');
                } else {
                    document.getElementById('sale-countdown').innerText = `${days} Days`;
                    document.getElementById('steam-status-label').innerText = "UPCOMING EVENT";
                }
            }
            let roadmapHtml = "";
            futureSales.forEach(s => roadmapHtml += `<div class="roadmap-item"><span>${s.name}</span><span>${s.start.toLocaleDateString('en-US',{month:'short',day:'numeric'})}</span></div>`);
            if(futureSales.length === 0) roadmapHtml = "<div style='color:#555; font-size:0.8rem; text-align:center;'>See you in 2026!</div>";
            document.getElementById('steam-roadmap-list').innerHTML = roadmapHtml;
        }
        renderSteamInfo();

        async function fetchHolidays() {
            try {
                const res = await fetch(`https://api-harilibur.vercel.app/api?year=${viewDate.getFullYear()}`);
                const data = await res.json();
                skbHolidays = {};
                data.forEach(item => { if(item.is_national_holiday) {
                    const d = new Date(item.holiday_date);
                    skbHolidays[`${d.getMonth()+1}-${d.getDate()}`] = item.holiday_name;
                }});
                renderCalendar(); updateInfoPanel(selectedDate);
            } catch(e) {}
        }
        function updateOffset() { hijriOffset = parseInt(document.getElementById('hijri-offset').value); localStorage.setItem('gx_hijri_offset', hijriOffset); updateInfoPanel(selectedDate); renderCalendar(); }
        function changeMonth(step) { viewDate.setMonth(viewDate.getMonth() + step); fetchHolidays(); renderCalendar(); }
        function getAdjustedDate(d) { const a = new Date(d); a.setDate(a.getDate() + hijriOffset); return a; }
        
        function getIslamicEvents(d) {
            try {
                const hFull = new Intl.DateTimeFormat('en-US-u-ca-islamic-umalqura', {day:'numeric', month:'numeric'}).format(getAdjustedDate(d));
                const [hM, hD] = hFull.split('/').map(Number);
                const w = d.getDay();
                let ev=[];
                if(w===1)ev.push("Puasa Senin"); if(w===4)ev.push("Puasa Kamis");
                if([13,14,15].includes(hD))ev.push("Ayyamul Bidh");
                if(hM===9)ev.push("Ramadhan"); if(hM===10&&hD===1)ev.push("Idul Fitri");
                if(hM===12&&hD===9)ev.push("Arafah"); if(hM===12&&hD===10)ev.push("Idul Adha");
                return ev.length>0?ev.join(", "):null;
            } catch (e) { return null; }
        }

        function updateInfoPanel(d) {
            const key = `${d.getMonth()+1}-${d.getDate()}`;
            document.getElementById('info-indo').innerHTML = (skbHolidays[key] || fixedHolidays[key]) ? `<span style="color:#ff4081; font-weight:bold;">${skbHolidays[key] || fixedHolidays[key]}</span>` : "<span style='color:#666'>-</span>";
            document.getElementById('info-masehi').innerHTML = d.toLocaleDateString('id-ID', {weekday:'long', day:'numeric', month:'long'});
            
            let hDate = "-";
            try {
                hDate = new Intl.DateTimeFormat('id-ID-u-ca-islamic-umalqura', {day:'numeric', month:'long', year:'numeric'}).format(getAdjustedDate(d));
            } catch (e) { hDate = "N/A"; }
            
            const hEv = getIslamicEvents(d);
            document.getElementById('info-hijri').innerHTML = `<div style="margin-bottom:2px; font-size:0.7rem; color:#aaa;">${hDate}</div>` + (hEv ? `<div class="ec-highlight">${hEv}</div>` : "");
        }
        function renderCalendar() {
            const y = viewDate.getFullYear(), m = viewDate.getMonth();
            document.getElementById('cal-month-year').innerText = viewDate.toLocaleDateString('en-US', {month:'long', year:'numeric'});
            const first = new Date(y, m, 1).getDay(), total = new Date(y, m+1, 0).getDate();
            const grid = document.getElementById('calendar-grid'); grid.innerHTML = "";
            ['Su','Mo','Tu','We','Th','Fr','Sa'].forEach(d=>grid.innerHTML+=`<div class="cal-day-name">${d}</div>`);
            for(let i=0; i<first; i++) grid.innerHTML+=`<div class="cal-date empty"></div>`;
            for(let i=1; i<=total; i++) {
                const d = new Date(y, m, i);
                const key = `${m+1}-${i}`;
                const el = document.createElement('div'); el.className = "cal-date"; el.innerText = i;
                if(i===currentDate.getDate() && m===currentDate.getMonth() && y===currentDate.getFullYear()) el.classList.add('today');
                if(d.getDay()===0 || skbHolidays[key] || fixedHolidays[key]) el.classList.add('holiday');
                if(i===selectedDate.getDate() && m===selectedDate.getMonth() && y===selectedDate.getFullYear()) el.classList.add('selected');
                if(getIslamicEvents(d)) el.classList.add('has-event');
                el.onclick = () => { selectedDate = d; renderCalendar(); updateInfoPanel(d); };
                grid.appendChild(el);
            }
        }
        fetchHolidays(); renderCalendar(); updateInfoPanel(currentDate);
    </script>
</body>
</html>
