<!DOCTYPE html>
<html lang="id">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>GXDiag - Pro Keyboard Tester</title>
Â  Â  <link rel="stylesheet" href="../../css/style.css">
Â  Â  <style>
Â  Â  Â  Â  /* --- STYLE KHUSUS HALAMAN INI --- */
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* HEADER & CONTROLS */
Â  Â  Â  Â  .kb-header {Â 
Â  Â  Â  Â  Â  Â  display: flex; justify-content: space-between; width: 100%;Â 
Â  Â  Â  Â  Â  Â  max-width: 1260px; margin-bottom: 20px; align-items: center;Â 
Â  Â  Â  Â  Â  Â  flex-wrap: wrap; gap: 10px; margin-top: 40px;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .controls { display: flex; gap: 10px; }
Â  Â  Â  Â  .ctrl-box {Â 
Â  Â  Â  Â  Â  Â  background: #1e1e1e; padding: 5px 15px; border-radius: 30px;Â 
Â  Â  Â  Â  Â  Â  border: 1px solid #333; display: flex; align-items: center; gap: 10px;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* DASHBOARD */
Â  Â  Â  Â  .dashboard {
Â  Â  Â  Â  Â  Â  width: 100%; max-width: 1260px; display: grid;Â 
Â  Â  Â  Â  Â  Â  grid-template-columns: 2fr 1fr; gap: 15px; margin-bottom: 30px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .dash-panel {
Â  Â  Â  Â  Â  Â  background: #1e1e1e; border: 1px solid #333; border-radius: 12px;
Â  Â  Â  Â  Â  Â  padding: 15px; height: 150px; display: flex; flex-direction: column;Â 
Â  Â  Â  Â  Â  Â  position: relative; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
Â  Â  Â  Â  }
Â  Â  Â  Â  .panel-head {Â 
Â  Â  Â  Â  Â  Â  display: flex; justify-content: space-between; font-size: 0.8rem;Â 
Â  Â  Â  Â  Â  Â  color: #00e5ff; font-weight: bold; margin-bottom: 5px;Â 
Â  Â  Â  Â  Â  Â  border-bottom: 1px solid #333; padding-bottom: 5px;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  /* LOG & STATS */
Â  Â  Â  Â  #key-history { flex-grow: 1; overflow-y: auto; display: flex; flex-wrap: wrap; gap: 5px; align-content: flex-start; }
Â  Â  Â  Â  .log-item { background: #2a2a2a; padding: 4px 8px; border-radius: 4px; font-size: 11px; border: 1px solid #333; font-family: monospace; color: #00e5ff; }
Â  Â  Â  Â  .log-item.err { color: #ff4081; border-color: #ff4081; }
Â  Â  Â  Â  .stats-col { display: flex; flex-direction: column; justify-content: center; gap: 10px; height: 100%; }
Â  Â  Â  Â  .stat-row { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px dashed #333; padding-bottom: 2px; }
Â  Â  Â  Â  .stat-val { font-size: 1.4rem; font-weight: bold; color: #fff; font-family: monospace; }
Â  Â  Â  Â  .stat-lbl { font-size: 0.75rem; color: #888; font-weight: bold; }

Â  Â  Â  Â  /* --- THE KEYBOARD LAYOUT FIX --- */
Â  Â  Â  Â  .wrapper {Â 
Â  Â  Â  Â  Â  Â  width: 100%; display: flex; justify-content: center;Â 
Â  Â  Â  Â  Â  Â  margin-bottom: 50px; /* Jarak bawah lebih lega */
Â  Â  Â  Â  }

Â  Â  Â  Â  .kb-container {Â 
Â  Â  Â  Â  Â  Â  position: relative;Â 
Â  Â  Â  Â  Â  Â  background: #181818;Â 
Â  Â  Â  Â  Â  Â  padding: 30px;Â 
Â  Â  Â  Â  Â  Â  border-radius: 15px;Â 
Â  Â  Â  Â  Â  Â  box-shadow: 0 20px 50px rgba(0,0,0,0.5);Â 
Â  Â  Â  Â  Â  Â  border-bottom: 10px solid #000;Â 
Â  Â  Â  Â  Â  Â  display: flex;Â 
Â  Â  Â  Â  Â  Â  gap: 20px;Â 
Â  Â  Â  Â  Â  Â  align-items: flex-start; /* Default align top, nanti kita margin manual */
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  /* UKURAN FIX STANDARD FULLSIZE */
Â  Â  Â  Â  Â  Â  width: 1300px;Â 
Â  Â  Â  Â  Â  Â  min-width: 1300px;Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  transform-origin: top center;Â 
Â  Â  Â  Â  Â  Â  transition: transform 0.1s linear;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* BLOK UTAMA (ALPHANUMERIC) */
Â  Â  Â  Â  .block-main { display: flex; flex-direction: column; gap: 6px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* PEMISAH F-KEYS (F1-F12) DENGAN ANGKA */
Â  Â  Â  Â  /* Baris pertama (F-Keys) dikasih margin bawah besar */
Â  Â  Â  Â  .block-main .row:first-child {
Â  Â  Â  Â  Â  Â  margin-bottom: 25px; /* Jarak F-Key ke Angka */
Â  Â  Â  Â  }

Â  Â  Â  Â  /* BLOK NAVIGASI (COMMANDS & ARROWS) */
Â  Â  Â  Â  .block-nav {Â 
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column; width: 162px;Â 
Â  Â  Â  Â  Â  Â  /* Turunkan Navigation Block agar sejajar dengan Backspace, BUKAN F-Keys */
Â  Â  Â  Â  Â  Â  padding-top: 80px;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Jarak antara Command Keys (Ins/Home) dengan Arrow Keys */
Â  Â  Â  Â  .nav-cmd { margin-bottom: 45px; }Â 

Â  Â  Â  Â  /* BLOK NUMPAD */
Â  Â  Â  Â  .block-num {Â 
Â  Â  Â  Â  Â  Â  display: grid; grid-template-columns: repeat(4, 50px);Â 
Â  Â  Â  Â  Â  Â  grid-template-rows: repeat(5, 50px); gap: 6px; width: 218px;Â 
Â  Â  Â  Â  Â  Â  /* Turunkan Numpad agar sejajar dengan Backspace */
Â  Â  Â  Â  Â  Â  padding-top: 80px;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Row Helper */
Â  Â  Â  Â  .row { display: flex; gap: 6px; position: relative; }
Â  Â  Â  Â  .nav-sys { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; margin-bottom: 10px; position: absolute; top: 30px; /* Sys Keys (PrtSc) naik ke atas sejajar F-Keys */ }
Â  Â  Â  Â  .nav-cmd { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; }
Â  Â  Â  Â  .nav-arr { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; }

Â  Â  Â  Â  /* DESAIN TOMBOL */
Â  Â  Â  Â  .key { height: 50px; width: 50px; background: #333; color: #ddd; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 600; cursor: default; border-bottom: 4px solid #1a1a1a; border-top: 1px solid #444; transition: 0.05s; }
Â  Â  Â  Â  .key.active { background: #f0faff; color: #111; border-bottom: 2px solid #ccc; transform: translateY(2px); box-shadow: 0 0 15px #00e5ff; z-index: 100; }
Â  Â  Â  Â  .key.tested { background: #004455; color: #00e5ff; border-color: #002233; }

Â  Â  Â  Â  /* UKURAN KHUSUS */
Â  Â  Â  Â  .w-125 { width: 62px; } .w-15 { width: 78px; } .w-175 { width: 92px; } .w-2 { width: 106px; } .w-225 { width: 121px; } .w-275 { width: 149px; } .w-space { width: 342px; }
Â  Â  Â  Â  .key[data-code="Numpad0"] { grid-column: span 2; width: 106px; }Â 
Â  Â  Â  Â  .key[data-code="NumpadAdd"] { grid-row: span 2; height: 106px; }Â 
Â  Â  Â  Â  .key[data-code="NumpadEnter"] { grid-row: span 2; height: 106px; }

Â  Â  Â  Â  /* ISO FIX */
Â  Â  Â  Â  .iso-key { display: none; } .kb-container.iso-mode .iso-key { display: flex; } .kb-container.iso-mode .ansi-key { display: none; }
Â  Â  Â  Â  .kb-container.iso-mode .key[data-code="Enter"] { position: absolute; right: 0; top: -56px; height: 106px; width: 65px; z-index: 5; border-radius: 5px 5px 5px 15px; }
Â  Â  Â  Â  .kb-container.iso-mode .key[data-code="ShiftLeft"] { width: 62px; }

Â  Â  Â  Â  /* Switches & Alert */
Â  Â  Â  Â  .switch { position: relative; display: inline-block; width: 40px; height: 20px; }
Â  Â  Â  Â  .switch input { opacity: 0; width: 0; height: 0; }
Â  Â  Â  Â  .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #555; transition: .4s; border-radius: 34px; }
Â  Â  Â  Â  .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
Â  Â  Â  Â  input:checked + .slider { background-color: #00e5ff; }
Â  Â  Â  Â  input:checked + .slider:before { transform: translateX(20px); }
Â  Â  Â  Â  .alert-box { background: #b71c1c; color: white; padding: 10px 20px; border-radius: 30px; position: fixed; top: 80px; left: 50%; transform: translateX(-50%); display: none; z-index: 999; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }

Â  Â  Â  Â  @media (max-width: 800px) { .dashboard { grid-template-columns: 1fr; } }
Â  Â  </style>
</head>
<body>
Â  Â  <a href="../../index.html" class="back-btn">â† MENU</a>
Â  Â  <div id="chatter-alert" class="alert-box">âš ï¸ CHATTER DETECTED! <span id="chatter-key"></span></div>

Â  Â  <div class="kb-header">
Â  Â  Â  Â  <h2 style="margin:0; font-size:1.5rem;">Keyboard Tester</h2>
Â  Â  Â  Â  <div class="controls">
Â  Â  Â  Â  Â  Â  <div class="ctrl-box">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="ctrl-label">ANSI</span>
Â  Â  Â  Â  Â  Â  Â  Â  <label class="switch"><input type="checkbox" id="layout-toggle" onchange="toggleLayout()"><span class="slider"></span></label>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="ctrl-label" style="color:#00e5ff;">ISO</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="ctrl-box">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="ctrl-label">ğŸ”Š Sound</span>
Â  Â  Â  Â  Â  Â  Â  Â  <label class="switch"><input type="checkbox" id="sound-toggle" checked><span class="slider"></span></label>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="dashboard">
Â  Â  Â  Â  <div class="dash-panel">
Â  Â  Â  Â  Â  Â  <div class="panel-head">INPUT HISTORY <span style="cursor:pointer; color:#ff4081" onclick="clearLog()">[CLEAR]</span></div>
Â  Â  Â  Â  Â  Â  <div id="key-history"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="dash-panel">
Â  Â  Â  Â  Â  Â  <div class="panel-head">STATISTICS</div>
Â  Â  Â  Â  Â  Â  <div class="stats-col">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-row"><span class="stat-lbl">PRESSED NOW</span><span class="stat-val" id="ghost-curr" style="color:#fff">0</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-row"><span class="stat-lbl">MAX GHOSTING</span><span class="stat-val" id="ghost-max" style="color:#00e5ff">0</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-row"><span class="stat-lbl">TYPING KPM</span><span class="stat-val" id="kpm">0</span></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="wrapper">
Â  Â  Â  Â  <div class="kb-container" id="kb-case">
Â  Â  Â  Â  Â  Â  <div class="block-main">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="row">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" style="margin-right:30px;" data-code="Escape">Esc</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="F1">F1</div><div class="key" data-code="F2">F2</div><div class="key" data-code="F3">F3</div><div class="key" style="margin-right:20px;" data-code="F4">F4</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="F5">F5</div><div class="key" data-code="F6">F6</div><div class="key" data-code="F7">F7</div><div class="key" style="margin-right:20px;" data-code="F8">F8</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="F9">F9</div><div class="key" data-code="F10">F10</div><div class="key" data-code="F11">F11</div><div class="key" data-code="F12">F12</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="row">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="Backquote">~</div><div class="key" data-code="Digit1">1</div><div class="key" data-code="Digit2">2</div><div class="key" data-code="Digit3">3</div><div class="key" data-code="Digit4">4</div><div class="key" data-code="Digit5">5</div><div class="key" data-code="Digit6">6</div><div class="key" data-code="Digit7">7</div><div class="key" data-code="Digit8">8</div><div class="key" data-code="Digit9">9</div><div class="key" data-code="Digit0">0</div><div class="key" data-code="Minus">-</div><div class="key" data-code="Equal">=</div><div class="key w-2" data-code="Backspace">Back</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><div class="key w-15" data-code="Tab">Tab</div><div class="key" data-code="KeyQ">Q</div><div class="key" data-code="KeyW">W</div><div class="key" data-code="KeyE">E</div><div class="key" data-code="KeyR">R</div><div class="key" data-code="KeyT">T</div><div class="key" data-code="KeyY">Y</div><div class="key" data-code="KeyU">U</div><div class="key" data-code="KeyI">I</div><div class="key" data-code="KeyO">O</div><div class="key" data-code="KeyP">P</div><div class="key" data-code="BracketLeft">[</div><div class="key" data-code="BracketRight">]</div><div class="key w-15 ansi-key" data-code="Backslash">\</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><div class="key w-175" data-code="CapsLock">Caps</div><div class="key" data-code="KeyA">A</div><div class="key" data-code="KeyS">S</div><div class="key" data-code="KeyD">D</div><div class="key" data-code="KeyF">F</div><div class="key" data-code="KeyG">G</div><div class="key" data-code="KeyH">H</div><div class="key" data-code="KeyJ">J</div><div class="key" data-code="KeyK">K</div><div class="key" data-code="KeyL">L</div><div class="key" data-code="Semicolon">;</div><div class="key" data-code="Quote">'</div><div class="key iso-key" data-code="Backslash">#</div><div class="key w-225" data-code="Enter">Enter</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><div class="key w-225" data-code="ShiftLeft">Shift</div><div class="key iso-key" data-code="IntlBackslash">\</div><div class="key" data-code="KeyZ">Z</div><div class="key" data-code="KeyX">X</div><div class="key" data-code="KeyC">C</div><div class="key" data-code="KeyV">V</div><div class="key" data-code="KeyB">B</div><div class="key" data-code="KeyN">N</div><div class="key" data-code="KeyM">M</div><div class="key" data-code="Comma">,</div><div class="key" data-code="Period">.</div><div class="key" data-code="Slash">/</div><div class="key w-275" data-code="ShiftRight">Shift</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><div class="key w-125" data-code="ControlLeft">Ctrl</div><div class="key w-125" data-code="MetaLeft">Win</div><div class="key w-125" data-code="AltLeft">Alt</div><div class="key w-space" data-code="Space">Space</div><div class="key w-125" data-code="AltRight">Alt</div><div class="key w-125" data-code="MetaRight">Win</div><div class="key" data-code="ContextMenu">Mn</div><div class="key w-125" data-code="ControlRight">Ctrl</div></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="block-nav">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="nav-sys">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="PrintScreen">Prt</div><div class="key" data-code="ScrollLock">Scr</div><div class="key" data-code="Pause">Pau</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="nav-cmd">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="Insert">Ins</div><div class="key" data-code="Home">Hm</div><div class="key" data-code="PageUp">PU</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="Delete">Del</div><div class="key" data-code="End">Ed</div><div class="key" data-code="PageDown">PD</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="nav-arr" style="margin-top: 45px;">Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div></div><div class="key" data-code="ArrowUp">â†‘</div><div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="ArrowLeft">â†</div><div class="key" data-code="ArrowDown">â†“</div><div class="key" data-code="ArrowRight">â†’</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="block-num">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="NumLock">Num</div><div class="key" data-code="NumpadDivide">/</div><div class="key" data-code="NumpadMultiply">*</div><div class="key" data-code="NumpadSubtract">-</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="Numpad7">7</div><div class="key" data-code="Numpad8">8</div><div class="key" data-code="Numpad9">9</div><div class="key" data-code="NumpadAdd">+</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="Numpad4">4</div><div class="key" data-code="Numpad5">5</div><div class="key" data-code="Numpad6">6</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="Numpad1">1</div><div class="key" data-code="Numpad2">2</div><div class="key" data-code="Numpad3">3</div><div class="key" data-code="NumpadEnter">Ent</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="key" data-code="Numpad0">0</div><div class="key" data-code="NumpadDecimal">.</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  // --- AUDIO ENGINE ---
Â  Â  Â  Â  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
Â  Â  Â  Â  let noiseBuffer = null;
Â  Â  Â  Â  function playSound() {
Â  Â  Â  Â  Â  Â  if (audioCtx.state === 'suspended') audioCtx.resume();
Â  Â  Â  Â  Â  Â  if (!document.getElementById('sound-toggle').checked) return;
Â  Â  Â  Â  Â  Â  if (!noiseBuffer) {
Â  Â  Â  Â  Â  Â  Â  Â  const b = audioCtx.createBuffer(1, audioCtx.sampleRate, audioCtx.sampleRate);
Â  Â  Â  Â  Â  Â  Â  Â  const d = b.getChannelData(0); for(let i=0; i<d.length; i++) d[i] = Math.random()*2-1;
Â  Â  Â  Â  Â  Â  Â  Â  noiseBuffer = b;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  const s = audioCtx.createBufferSource(); s.buffer = noiseBuffer;
Â  Â  Â  Â  Â  Â  const f = audioCtx.createBiquadFilter(); f.type='highpass'; f.frequency.value=1200;
Â  Â  Â  Â  Â  Â  const g = audioCtx.createGain(); g.gain.setValueAtTime(0.5, audioCtx.currentTime);Â 
Â  Â  Â  Â  Â  Â  g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime+0.03);
Â  Â  Â  Â  Â  Â  s.connect(f); f.connect(g); g.connect(audioCtx.destination);
Â  Â  Â  Â  Â  Â  s.start(); s.stop(audioCtx.currentTime+0.04);
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- KEYBOARD LOGIC ---
Â  Â  Â  Â  let activeKeys = new Set(), maxSim = 0, lastKeyTime = {}, startTime = null, count = 0;
Â  Â  Â  Â Â 
Â  Â  Â  Â  function toggleLayout() {
Â  Â  Â  Â  Â  Â  document.getElementById('kb-case').classList.toggle('iso-mode');
Â  Â  Â  Â  Â  Â  setTimeout(autoScaleKeyboard, 50);
Â  Â  Â  Â  }
Â  Â  Â  Â  function format(code) { return code.replace('Key','').replace('Digit','').replace('Numpad','Num '); }
Â  Â  Â  Â  function clearLog() { document.getElementById('key-history').innerHTML = ''; }

Â  Â  Â  Â  window.addEventListener('keydown', e => {
Â  Â  Â  Â  Â  Â  if (e.repeat) return;
Â  Â  Â  Â  Â  Â  if (['Tab','AltLeft','AltRight'].includes(e.code) || e.code.startsWith('F')) e.preventDefault();
Â  Â  Â  Â  Â  Â  playSound();
Â  Â  Â  Â  Â  Â  const now = Date.now(), last = lastKeyTime[e.code] || 0;
Â  Â  Â  Â  Â  Â  if (last && now-last < 80) {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('chatter-key').innerText = format(e.code) + ` (${now-last}ms)`;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('chatter-alert').style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(()=>document.getElementById('chatter-alert').style.display='none',3000);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  lastKeyTime[e.code] = now;
Â  Â  Â  Â  Â  Â  activeKeys.add(e.code); count++;
Â  Â  Â  Â  Â  Â  if(!startTime) { startTime=now; setInterval(()=>{
Â  Â  Â  Â  Â  Â  Â  Â  const m = (Date.now()-startTime)/60000;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('kpm').innerText = m>0?Math.round(count/m):0;
Â  Â  Â  Â  Â  Â  },1000); }
Â  Â  Â  Â  Â  Â  document.getElementById('ghost-curr').innerText = activeKeys.size;
Â  Â  Â  Â  Â  Â  if(activeKeys.size > maxSim) document.getElementById('ghost-max').innerText = maxSim = activeKeys.size;
Â  Â  Â  Â  Â  Â  document.querySelectorAll(`.key[data-code="${e.code}"]`).forEach(k=>{k.classList.add('active','tested')});
Â  Â  Â  Â  Â  Â  const l = document.createElement('div'); l.className = 'log-item';
Â  Â  Â  Â  Â  Â  if(now-last < 80) l.classList.add('err');
Â  Â  Â  Â  Â  Â  l.innerText = format(e.code);
Â  Â  Â  Â  Â  Â  document.getElementById('key-history').prepend(l);
Â  Â  Â  Â  });

Â  Â  Â  Â  window.addEventListener('keyup', e => {
Â  Â  Â  Â  Â  Â  activeKeys.delete(e.code);
Â  Â  Â  Â  Â  Â  document.querySelectorAll(`.key[data-code="${e.code}"]`).forEach(k=>k.classList.remove('active'));
Â  Â  Â  Â  Â  Â  document.getElementById('ghost-curr').innerText = activeKeys.size;
Â  Â  Â  Â  });

Â  Â  Â  Â  // --- AGGRESSIVE AUTO SCALE ---
Â  Â  Â  Â  function autoScaleKeyboard() {
Â  Â  Â  Â  Â  Â  const wrapper = document.querySelector('.wrapper');
Â  Â  Â  Â  Â  Â  const keyboard = document.getElementById('kb-case');
Â  Â  Â  Â  Â  Â  const originalWidth = 1300;Â 
Â  Â  Â  Â  Â  Â  const screenWidth = window.innerWidth - 60; // Safe buffer
Â  Â  Â  Â  Â  Â  let scale = screenWidth / originalWidth;
Â  Â  Â  Â  Â  Â  if (scale > 1) scale = 1;
Â  Â  Â  Â  Â  Â  keyboard.style.transform = `scale(${scale})`;
Â  Â  Â  Â  Â  Â  wrapper.style.height = (keyboard.offsetHeight * scale) + 'px';
Â  Â  Â  Â  }

Â  Â  Â  Â  window.addEventListener('load', autoScaleKeyboard);
Â  Â  Â  Â  window.addEventListener('resize', autoScaleKeyboard);
Â  Â  </script>
</body>
</html>
