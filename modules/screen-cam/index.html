<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GXDiag - Screen & Cam</title>
    <link rel="stylesheet" href="../../css/style.css">
    <style>
        body { background: #000; color: #fff; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        .mod-header { padding: 15px; background: #111; border-bottom: 1px solid #333; display: flex; justify-content: space-between; z-index: 10; }
        .back-btn { text-decoration: none; color: #fff; font-weight: bold; }
        
        .main-container { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        
        /* FPS COUNTER */
        .fps-box {
            position: absolute; top: 20px; right: 20px;
            background: rgba(0,0,0,0.7); border: 1px solid #00ff88;
            padding: 10px 20px; border-radius: 8px; font-family: monospace;
            color: #00ff88; font-weight: bold; z-index: 5;
        }

        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; max-width: 400px; width: 100%; z-index: 5; }
        .test-btn { padding: 20px; background: #222; border: 1px solid #444; color: #fff; border-radius: 10px; cursor: pointer; }
        .test-btn:hover { background: #00e5ff; color: #000; }

        /* FULLSCREEN COLOR OVERLAY */
        #color-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 20; display: none; cursor: pointer; }
        
        /* WEBCAM */
        #cam-feed { width: 100%; max-width: 640px; border: 2px solid #333; margin-top: 20px; display: none; }
        .cam-info { margin-top: 10px; color: #888; font-size: 0.9rem; }
    </style>
</head>
<body>
    <div class="mod-header">
        <a href="../../index.html" class="back-btn">‚Üê DASHBOARD</a>
        <div>SCREEN & CAM</div>
    </div>

    <div class="main-container">
        <div class="fps-box" id="fps-display">FPS: --</div>

        <div class="btn-grid">
            <button class="test-btn" onclick="startDeadPixel()">üñ•Ô∏è Dead Pixel Test</button>
            <button class="test-btn" onclick="startWebcam()">üì∏ Check Webcam</button>
        </div>

        <video id="cam-feed" autoplay playsinline></video>
        <div class="cam-info" id="cam-info"></div>
    </div>

    <div id="color-overlay" onclick="nextColor()"></div>

    <script>
        // FPS LOGIC
        let lastLoop = new Date();
        function countFPS() { 
            let thisLoop = new Date();
            let fps = 1000 / (thisLoop - lastLoop);
            lastLoop = thisLoop;
            document.getElementById('fps-display').innerText = "FPS: " + Math.round(fps);
            requestAnimationFrame(countFPS);
        }
        requestAnimationFrame(countFPS);

        // DEAD PIXEL LOGIC
        const overlay = document.getElementById('color-overlay');
        const colors = ['red', 'green', 'blue', 'white', 'black'];
        let colorIdx = 0;

        function startDeadPixel() {
            colorIdx = 0;
            overlay.style.backgroundColor = colors[colorIdx];
            overlay.style.display = 'block';
            document.documentElement.requestFullscreen();
        }

        function nextColor() {
            colorIdx++;
            if (colorIdx >= colors.length) {
                overlay.style.display = 'none';
                if(document.fullscreenElement) document.exitFullscreen();
            } else {
                overlay.style.backgroundColor = colors[colorIdx];
            }
        }

        // WEBCAM LOGIC
        async function startWebcam() {
            const video = document.getElementById('cam-feed');
            const info = document.getElementById('cam-info');
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                video.srcObject = stream;
                video.style.display = 'block';
                const track = stream.getVideoTracks()[0];
                const settings = track.getSettings();
                info.innerText = `Res: ${settings.width}x${settings.height} | Device: ${track.label}`;
            } catch (err) {
                alert("Camera Access Denied / Not Found");
            }
        }
    </script>
</body>
</html>
