<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GXDiag - Screen & Cam</title>
    <link rel="stylesheet" href="../../css/style.css">
    <style>
        /* Dead Pixel Colors */
        .color-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-bottom: 20px; }
        .color-btn { height: 60px; border: 2px solid #444; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .color-btn:hover { transform: scale(1.05); border-color: #fff; }

        /* Fullscreen Overlay */
        #dp-overlay { 
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; 
            z-index: 9999; display: none; cursor: none;
        }
        #exit-hint {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
            color: rgba(255,255,255,0.3); font-size: 2rem; font-weight: bold; pointer-events: none;
        }

        /* Webcam */
        .cam-wrapper { 
            width: 100%; height: 300px; background: #000; border-radius: 10px; 
            overflow: hidden; position: relative; border: 2px solid #333;
        }
        video { width: 100%; height: 100%; object-fit: contain; transform: scaleX(-1); /* Mirror effect */ }
        .cam-overlay { 
            position: absolute; top:0; left:0; width:100%; height:100%; 
            display:flex; justify-content:center; align-items:center; background: rgba(0,0,0,0.7); 
        }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <a href="../../index.html" class="back-btn">‚Üê MENU</a>
    <h2>Display & Camera</h2>

    <div id="dp-overlay" onclick="closeDeadPixel()"><div id="exit-hint">TAP TO EXIT</div></div>

    <div class="panel">
        <h3>Dead Pixel Check</h3>
        <p style="color:#888; font-size:0.9rem; margin-bottom:15px;">Klik warna di bawah untuk masuk ke mode layar penuh. Cari titik piksel yang mati (hitam) atau stuck (berwarna).</p>
        <div class="color-grid">
            <button class="color-btn" style="background:red" onclick="openDeadPixel('red')"></button>
            <button class="color-btn" style="background:lime" onclick="openDeadPixel('lime')"></button>
            <button class="color-btn" style="background:blue" onclick="openDeadPixel('blue')"></button>
            <button class="color-btn" style="background:white" onclick="openDeadPixel('white')"></button>
            <button class="color-btn" style="background:black; border-color:#555" onclick="openDeadPixel('black')"></button>
        </div>
    </div>

    <div class="panel">
        <h3>Webcam Tester</h3>
        <div class="cam-wrapper">
            <video id="cam-feed" autoplay playsinline muted></video>
            <div id="cam-ui" class="cam-overlay">
                <button onclick="startCam()" style="padding:15px 30px; background:#00e5ff; border:none; border-radius:30px; font-weight:bold; cursor:pointer;">START CAMERA</button>
            </div>
        </div>
        <p id="cam-info" style="margin-top:10px; color:#00e5ff; font-family:monospace;"></p>
    </div>

    <script>
        // --- DEAD PIXEL LOGIC ---
        const overlay = document.getElementById('dp-overlay');
        function openDeadPixel(color) {
            overlay.style.display = 'block';
            overlay.style.backgroundColor = color;
            if(document.documentElement.requestFullscreen) document.documentElement.requestFullscreen();
            
            // Sembunyikan hint setelah 2 detik
            const hint = document.getElementById('exit-hint');
            hint.style.display = 'block';
            setTimeout(() => hint.style.display = 'none', 2000);
        }
        function closeDeadPixel() {
            overlay.style.display = 'none';
            if(document.exitFullscreen) document.exitFullscreen();
        }

        // --- WEBCAM LOGIC ---
        async function startCam() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: { width: 1280, height: 720 } });
                const video = document.getElementById('cam-feed');
                video.srcObject = stream;
                document.getElementById('cam-ui').classList.add('hidden');
                
                // Get Track Info
                const track = stream.getVideoTracks()[0];
                const settings = track.getSettings();
                document.getElementById('cam-info').innerText = `Resolution: ${settings.width}x${settings.height} | Label: ${track.label}`;
            } catch (e) {
                alert("Camera Error: " + e.message + "\n(Pastikan akses HTTPS/Localhost)");
            }
        }
    </script>
</body>
</html>
